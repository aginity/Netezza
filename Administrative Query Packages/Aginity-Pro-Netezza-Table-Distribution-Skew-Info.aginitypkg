{"entities":[{"fqn":"/Community Queries","id":"067ce53b-d1d2-431a-9f3d-4765eb18eebf","parent_folder_id":"bb6de4af-1aad-493e-a9ee-b3e75cf58ed7","name":"Community Queries","entity_type":"FOLDER"},{"fqn":"/Community Queries/Netezza/Administrative Queries/Distribution and skew for all tables in database","id":"1448e52a-0783-484b-bc29-8123f94d1d6b","parent_folder_id":"86a94f63-0111-40ca-a24d-b25c3bef25ec","name":"Distribution and skew for all tables in database","entity_type":"SQL_ENTITY","description":"","content":"select  \r\n  the_table.database as database_name\r\n  , the_table.objname table_name\r\n  , skew.used_bytes/pow(1024,2) as used_MB\r\n  , count(*) over (partition by the_table.database, the_table.objname) number_keys_for_distribution\r\n  , COALESCE(map.attname,'RANDOM') AS distribution_key\r\n  , map.distseqno AS distribution_seq_no\r\n  , skew.skew\r\n  , slices.num_data_slices\r\nfrom\r\n    _v_table as tab \r\n    LEFT OUTER JOIN _v_table_dist_map as map \r\n      ON map.objid = tab.objid\r\n    INNER JOIN _V_OBJ_RELATION_XDB as the_table \r\n      ON tab.database = the_table.database and tab.tablename = the_table.objname  \r\n    LEFT JOIN _V_TABLE_ONLY_STORAGE_STAT as skew\r\n      ON (the_table.objid = skew.objid )   \r\n    LEFT OUTER JOIN (select tblid, count(dsid) as num_data_slices from _V_SYS_OBJECT_DSLICE_INFO group by tblid) as slices\r\n      ON (the_table.objid = slices.tblid  and slices.tblid > 200000)\r\nwhere\r\n  1=1\r\n  and map.attname is not null\r\n  and UPPER(tab.objtype) IN ('TABLE','SECURE TABLE')\r\norder by\r\n\t1,2,4","type":"QUERY","platform":"Snowflake","executed_count":0},{"fqn":"/Community Queries/Netezza/Administrative Queries","id":"86a94f63-0111-40ca-a24d-b25c3bef25ec","parent_folder_id":"ab45a5e2-a392-48c1-8a20-010b0d696426","name":"Administrative Queries","entity_type":"FOLDER"},{"fqn":"/Community Queries/Netezza","id":"ab45a5e2-a392-48c1-8a20-010b0d696426","parent_folder_id":"067ce53b-d1d2-431a-9f3d-4765eb18eebf","name":"Netezza","entity_type":"FOLDER"},{"fqn":"/Community Queries/Netezza/Administrative Queries/Distribution and skew for the table","id":"fed6b4ed-b5e5-44ea-8d63-6993726a71f1","parent_folder_id":"86a94f63-0111-40ca-a24d-b25c3bef25ec","name":"Distribution and skew for the table","entity_type":"SQL_ENTITY","description":"","content":"select  \r\n  the_table.database as database_name\r\n  , the_table.objname table_name\r\n  , skew.used_bytes/pow(1024,2) as used_MB\r\n  , count(*) over (partition by the_table.database, the_table.objname) number_keys_for_distribution\r\n  , COALESCE(map.attname,'RANDOM') AS distribution_key\r\n  , map.distseqno AS distribution_seq_no\r\n  , skew.skew\r\n  , slices.num_data_slices\r\nfrom\r\n    _v_table as tab \r\n    LEFT OUTER JOIN _v_table_dist_map as map \r\n      ON map.objid = tab.objid\r\n    INNER JOIN _V_OBJ_RELATION_XDB as the_table \r\n      ON tab.database = the_table.database and tab.tablename = the_table.objname  \r\n    LEFT JOIN _V_TABLE_ONLY_STORAGE_STAT as skew\r\n      ON (the_table.objid = skew.objid )   \r\n    LEFT OUTER JOIN (select tblid, count(dsid) as num_data_slices from _V_SYS_OBJECT_DSLICE_INFO group by tblid) as slices\r\n      ON (the_table.objid = slices.tblid  and slices.tblid > 200000)\r\nwhere\r\n  1=1\r\n  and map.attname is not null\r\n  and UPPER(tab.objtype) IN ('TABLE','SECURE TABLE')\r\n  and lower(the_table.database) = lower('' ||$SCHEMA_NAME|| '') and lower(the_table.objname) = lower(''||$TABLE_NAME||'')\r\norder by\r\n\t1,2,4","type":"QUERY","platform":"Snowflake","executed_count":0}]}